!function(a,b){return"undefined"==typeof a._mu&&(a._mu={}),"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/cfg",b):a._mu.cfg=b()}(this,function(){var a;return a=this,$.extend({namespace:a._mu,debug:!1,version:"0.9.2",timerResolution:25,cdn:"http://apps.bdimg.com/libs/muplayer/",engine:{TYPES:{FLASH_MP3:"FlashMP3Core",FLASH_MP4:"FlashMP4Core",AUDIO:"AudioCore"},EVENTS:{STATECHANGE:"engine:statechange",POSITIONCHANGE:"engine:postionchange",PROGRESS:"engine:progress",ERROR:"engine:error",INIT:"engine:init",INIT_FAIL:"engine:init_fail",WAITING_TIMEOUT:"engine:waiting_timeout"},STATES:{CANPLAYTHROUGH:"canplaythrough",PREBUFFER:"waiting",BUFFERING:"loadeddata",PLAYING:"playing",PAUSE:"pause",STOP:"suspend",END:"ended"},ERRCODE:{MEDIA_ERR_ABORTED:"1",MEDIA_ERR_NETWORK:"2",MEDIA_ERR_DECODE:"3",MEDIA_ERR_SRC_NOT_SUPPORTED:"4"}}},"undefined"==typeof a._mu?{}:a._mu.cfg)}),function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/utils",["muplayer/core/cfg"],b):a._mu.utils=b(a._mu.cfg)}(this,function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(k={},e=String.prototype,c=Number.prototype,d=Object.prototype,b=Array.prototype,i=b.push,g=d.hasOwnProperty,j=d.toString,f=/\.(\w+)(\?.*)?$/,n=["Arguments","Function","String","Number","Date","RegExp"],l=0,m=n.length;m>l;l++)h=n[l],k["is"+h]=function(a){return function(b){return j.call(b)==="[object "+a+"]"}}(h);return $.isFunction(e.startsWith)||(e.startsWith=function(a){return this.slice(0,a.length)===a}),$.isFunction(e.endsWith)||(e.endsWith=function(a){return this.slice(-a.length)===a}),c.toFixed=function(a){var b,c,d;if(d=Math.pow(10,a),b=(Math.round(this*d)/d).toString(),0===a)return b;for(b.indexOf(".")<0&&(b+="."),c=a+1-(b.length-b.indexOf("."));c--;)b+="0";return b},$.extend(k,{isBoolean:function(a){return a===!0||a===!1||"[object Boolean]"===j.call(a)},has:function(a,b){return g.call(a,b)},random:function(a,b){return b||(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},shuffle:function(a){var b,c,d,e,f,g;for(b=0,e=[],f=0,g=a.length;g>f;f++)c=a[f],d=this.random(b++),e[b-1]=e[d],e[d]=c;return e},time2str:function(a){var b,c,d,e,f,g;return f=[],b=Math.floor,a=Math.round(a),c=b(a/3600),d=b((a-3600*c)/60),g=a%60,e=function(a,b){var c,d,e;return d="",c="",0>a&&(c="-"),e=String(Math.abs(a)),e.length<b&&(d=new Array(b-e.length+1).join("0")),c+d+e},c&&f.push(c),f.push(e(d,2)),f.push(e(g,2)),f.join(":")},namespace:function(){var b,c,d,e,f,g,h,i,j,k;for(b=arguments,h=".",i=0,j=b.length;j>i;i++)if(c=b[i],g=a.namespace,c.indexOf(h)>-1)for(d=c.split(h),k=[0,d.length],e=k[0],f=k[1];f>e;)g[d[e]]=g[d[e]]||{},g=g[d[e]],e++;else g[c]=g[c]||{},g=g[c];return g},wrap:function(a,b){return function(){var c;return c=[a],i.apply(c,arguments),b.apply(this,c)}},toAbsoluteUrl:function(a){var b;return b=document.createElement("div"),b.innerHTML="<a></a>",b.firstChild.href=a,b.innerHTML=b.innerHTML,b.firstChild.href},getExt:function(a){var b;return b="",f.test(decodeURIComponent(a))&&(b=RegExp.$1.toLocaleLowerCase()),b}}),k}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/lib/Timer",b):a._mu.Timer=b()}(this,function(){function a(a){if("string"==typeof a){isNaN(parseInt(a,10))&&(a="1"+a);var b=a.replace(/[^a-z0-9\.]/g,"").match(/(?:(\d+(?:\.\d+)?)(?:days?|d))?(?:(\d+(?:\.\d+)?)(?:hours?|hrs?|h))?(?:(\d+(?:\.\d+)?)(?:minutes?|mins?|m\b))?(?:(\d+(?:\.\d+)?)(?:seconds?|secs?|s))?(?:(\d+(?:\.\d+)?)(?:milliseconds?|ms))?/);if(b[0])return 864e5*parseFloat(b[1]||0)+36e5*parseFloat(b[2]||0)+6e4*parseFloat(b[3]||0)+1e3*parseFloat(b[4]||0)+parseInt(b[5]||0,10);if(!isNaN(parseInt(a,10)))return parseInt(a,10)}return"number"==typeof a?a:0}function b(a,b){return parseInt(a/b,10)||1}function c(b){return this instanceof c==!1?new c(b):(this._notifications=[],this._resolution=a(b)||1e3,this._running=!1,this._ticks=0,this._timer=null,void(this._drift=0))}return c.prototype={start:function(){var a=this;return this._running||(this._running=!this._running,setTimeout(function b(){a._ticks++;for(var c=0,d=a._notifications.length;d>c;c++)a._notifications[c]&&a._ticks%a._notifications[c].ticks===0&&a._notifications[c].callback.call(a._notifications[c],{ticks:a._ticks,resolution:a._resolution});a._running&&(clearTimeout(a._timer),a._timer=setTimeout(b,a._resolution+a._drift),a._drift=0)},this._resolution)),this},stop:function(){return this._running&&(this._running=!this._running,clearTimeout(this._timer)),this},reset:function(){return this.stop(),this._ticks=0,this},clear:function(){return this.reset(),this._notifications=[],this},ticks:function(){return this._ticks},resolution:function(){return this._resolution},running:function(){return this._running},bind:function(c,d){if(c&&d){var e=b(a(c),this._resolution);this._notifications.push({ticks:e,callback:d})}return this},unbind:function(a){if(a)for(var b=0,c=this._notifications.length;c>b;b++)this._notifications[b]&&this._notifications[b].callback===a&&this._notifications.splice(b,1);else this._notifications=[];return this},drift:function(a){return this._drift=a,this}},c.prototype.every=c.prototype.bind,c.prototype.after=function(a,b){var d=this;return c.prototype.bind.call(d,a,function e(){c.prototype.unbind.call(d,e),b.apply(this,arguments)}),this},c}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/lib/events",b):a._mu.Events=b()}(this,function(){function a(){}function b(a,b,c){if(a){var d=0,e=a.length,f=b[0],g=b[1],h=b[2],i=!0;switch(b.length){case 0:for(;e>d;d+=2)i=a[d].call(a[d+1]||c)!==!1&&i;break;case 1:for(;e>d;d+=2)i=a[d].call(a[d+1]||c,f)!==!1&&i;break;case 2:for(;e>d;d+=2)i=a[d].call(a[d+1]||c,f,g)!==!1&&i;break;case 3:for(;e>d;d+=2)i=a[d].call(a[d+1]||c,f,g,h)!==!1&&i;break;default:for(;e>d;d+=2)i=a[d].apply(a[d+1]||c,b)!==!1&&i}}return i}function c(a){return"[object Function]"===Object.prototype.toString.call(a)}var d=/\s+/;a.prototype.on=function(a,b,c){var e,f,g;if(!b)return this;for(e=this.__events||(this.__events={}),a=a.split(d);f=a.shift();)g=e[f]||(e[f]=[]),g.push(b,c);return this},a.prototype.once=function(a,b,c){var d=this,e=function(){d.off(a,e),b.apply(this,arguments)};this.on(a,e,c)},a.prototype.off=function(a,b,c){var f,g,h,i;if(!(f=this.__events))return this;if(!(a||b||c))return delete this.__events,this;for(a=a?a.split(d):e(f);g=a.shift();)if(h=f[g])if(b||c)for(i=h.length-2;i>=0;i-=2)b&&h[i]!==b||c&&h[i+1]!==c||h.splice(i,2);else delete f[g];return this},a.prototype.trigger=function(a){var c,e,f,g,h,i,j=[],k=!0;if(!(c=this.__events))return this;for(a=a.split(d),h=1,i=arguments.length;i>h;h++)j[h-1]=arguments[h];for(;e=a.shift();)(f=c.all)&&(f=f.slice()),(g=c[e])&&(g=g.slice()),k=b(g,j,this)&&k,k=b(f,[e].concat(j),this)&&k;return k},a.prototype.emit=a.prototype.trigger,a.mixTo=function(b){b=c(b)?b.prototype:b;var d=a.prototype;for(var e in d)d.hasOwnProperty(e)&&(b[e]=d[e])};var e=Object.keys;return e||(e=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),a});var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};!function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/playlist",["muplayer/core/utils","muplayer/lib/events"],b):a._mu.Playlist=b(_mu.utils,_mu.Events)}(this,function(a,b){var c;return c=function(){function b(a){this.next=__bind(this.next,this),this.prev=__bind(this.prev,this),this.opts=$.extend({},this.defaults,a),this.reset()}return b.prototype.reset=function(){return this.cur="",$.isArray(this.list)?this.list.length=0:this.list=[]},b.prototype._resetListRandom=function(b){var c;return"list-random"===this.mode?(b=b||0,this._listRandomIndex=b,this._listRandom=a.shuffle(function(){c=[];for(var a=0,b=this.list.length;b>=0?b>a:a>b;b>=0?a++:a--)c.push(a);return c}.apply(this)),this.cur=this.list[this._listRandom[b]]):void 0},b.prototype._formatSid=function(b){var c,d,e;return c=this.opts.absoluteUrl,d=function(b){return c&&a.toAbsoluteUrl(b)||""+b},$.isArray(b)&&function(){var a,c,f;for(f=[],a=0,c=b.length;c>a;a++)e=b[a],e&&f.push(d(e));return f}()||d(b)},b.prototype.setMode=function(a){return("single"===a||"random"===a||"list-random"===a||"list"===a||"loop"===a)&&(this.mode=a),this._resetListRandom()},b.prototype.add=function(a,b){return null==b&&(b=!0),a=this._formatSid(a),this.remove(a),$.isArray(a)&&a.length?this.list=b&&a.concat(this.list)||this.list.concat(a):a&&this.list[b&&"unshift"||"push"](a),this.trigger("playlist:add",a),this._resetListRandom()},b.prototype.remove=function(a){var b,c,d,e;if(c=function(a){return function(b){var c;return c=$.inArray(b,a.list),-1!==c?a.list.splice(c,1):void 0}}(this),a=this._formatSid(a),$.isArray(a))for(d=0,e=a.length;e>d;d++)b=a[d],c(b);else c(a);return this.trigger("playlist:remove",a),this._resetListRandom()},b.prototype.prev=function(){var b,c,d,e;switch(d=this.list,b=$.inArray(this.cur,d),c=d.length,e=b-1,this.mode){case"single":e=b;break;case"random":e=a.random(0,c-1);break;case"list":if(b=0)return this.cur="",!1;break;case"list-random":return b=this._listRandomIndex--,e=b-1,0===b&&(e=c-1,this._resetListRandom(e)),this.cur=d[this._listRandom[e]];case"loop":0===b&&(e=c-1)}return this.cur=d[e]},b.prototype.next=function(){var b,c,d,e;switch(d=this.list,b=$.inArray(this.cur,d),c=d.length,e=b+1,this.mode){case"single":e=b;break;case"random":e=a.random(0,c-1);break;case"list":if(b===c-1)return this.cur="",!1;break;case"list-random":return b=this._listRandomIndex++,e=b+1,b===c-1&&(e=0,this._resetListRandom(e)),this.cur=d[this._listRandom[e]];case"loop":b===c-1&&(e=0)}return this.cur=d[e]},b.prototype.setCur=function(a){return a=this._formatSid(a),__indexOf.call(this.list,a)<0&&this.add(a),this.cur=a},b}(),b.mixTo(c),c});var __indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};!function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/engines/engineCore",["muplayer/core/cfg","muplayer/core/utils","muplayer/lib/events"],b):a._mu.EngineCore=b(_mu.cfg,_mu.utils,_mu.Events)}(this,function(a,b,c){var d,e,f,g,h,i,j;return j=a.engine,d=j.EVENTS,f=j.STATES,g=function(){var a;a=[];for(h in f)i=f[h],a.push(i);return a}(),e=function(){function a(){}return a.prototype._supportedTypes=[],a.prototype.getSupportedTypes=function(){return this._supportedTypes},a.prototype.canPlayType=function(a){return"mp4a"===a&&(a="m4a"),-1!==$.inArray(a,this.getSupportedTypes())},a.prototype.reset=function(){return this.stop(),this.setUrl(),this.trigger(d.PROGRESS,0),this.trigger(d.POSITIONCHANGE,0)},a.prototype.play=function(){return this},a.prototype.pause=function(){return this},a.prototype.stop=function(){return this},a.prototype.setUrl=function(a){return null==a&&(a=""),this._url=a,this},a.prototype.getUrl=function(){return this._url},a.prototype.setState=function(a){var b,c;if(!(__indexOf.call(g,a)<0||a===this._state)&&(a!==f.BUFFERING||(c=this._state)!==f.END&&c!==f.PAUSE&&c!==f.STOP))return b=this._state,this._state=a,this.trigger(d.STATECHANGE,{oldState:b,newState:a})},a.prototype.getState=function(){return this._state},a.prototype.setVolume=function(a){return this._volume=a,this},a.prototype.getVolume=function(){return this._volume},a.prototype.setMute=function(a){return this._mute=a,this},a.prototype.getMute=function(){return this._mute},a.prototype.setCurrentPosition=function(){return this},a.prototype.getCurrentPosition=function(){return 0},a.prototype.getLoadedPercent=function(){return 0},a.prototype.getTotalTime=function(){return 0},a}(),c.mixTo(e),e}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/lib/modernizr.audio",b):a._mu.Modernizr=b()}(this,function(){return function(a,b,c){function d(a){n.cssText=a}function e(a,b){return typeof a===b}var f,g,h,i="2.7.1",j={},k=b.documentElement,l="modernizr",m=b.createElement(l),n=m.style,o=({}.toString,{}),p=[],q=p.slice,r={}.hasOwnProperty;h=e(r,"undefined")||e(r.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return r.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=q.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(q.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(q.call(arguments)))};return d}),o.audio=function(){var a=b.createElement("audio"),c=!1;try{(c=!!a.canPlayType)&&(c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),c.mp3=a.canPlayType("audio/mpeg;").replace(/^no$/,""),c.wav=a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),c.m4a=(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(d){}return c};for(var s in o)h(o,s)&&(g=s.toLowerCase(),j[g]=o[s](),p.push((j[g]?"":"no-")+g));return j.addTest=function(a,b){if("object"==typeof a)for(var d in a)h(a,d)&&j.addTest(d,a[d]);else{if(a=a.toLowerCase(),j[a]!==c)return j;b="function"==typeof b?b():b,"undefined"!=typeof enableClasses&&enableClasses&&(k.className+=" "+(b?"":"no-")+a),j[a]=b}return j},d(""),m=f=null,j._version=i,j}(this,this.document)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},__slice=[].slice;!function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/engines/audioCore",["muplayer/core/cfg","muplayer/core/utils","muplayer/core/engines/engineCore","muplayer/lib/modernizr.audio"],b):a._mu.AudioCore=b(_mu.cfg,_mu.utils,_mu.EngineCore,_mu.Modernizr)}(this,function(a,b,c,d){var e,f,g,h,i,j,k;return j=window,k=a.engine,i=k.TYPES,g=k.EVENTS,h=k.STATES,f=k.ERRCODE,e=function(a){function c(a){var b,e,f,g,i,k,l;if(this.opts=$.extend({},c.defaults,a),this.opts.emptyMP3=this.opts.baseDir+this.opts.emptyMP3,i=this.opts,g={"":0,maybe:1,probably:2},f=g[i.confidence],b=d.audio,!b)return this;for(e in b)l=b[e],g[l]>=f&&this._supportedTypes.push(e);b=new Audio,b.preload=i.preload,b.autoplay=i.autoplay,b.loop=!1,b.on=function(a,c){return b.addEventListener(a,c,!1),b},b.off=function(a,c){return b.removeEventListener(a,c,!1),b},this.audio=b,this._needCanPlay(["play","setCurrentPosition"]),this.setState(h.STOP),this._initEvents(),i.needPlayEmpty&&(k=function(a){return function(){return a.getUrl()||a.setUrl(i.emptyMP3).play(),j.removeEventListener("touchstart",k,!1)}}(this),j.addEventListener("touchstart",k,!1))}return __extends(c,a),c.defaults={confidence:"maybe",preload:!1,autoplay:!1,needPlayEmpty:!0,emptyMP3:"empty.mp3"},c.prototype._supportedTypes=[],c.prototype.engineType=i.AUDIO,c.prototype._test=function(){return d.audio&&this._supportedTypes.length?!0:!1},c.prototype._initEvents=function(){var a,b,c,d,e,f,i,j;return f=this,a=this.audio,i=this.trigger,j=[null,null,!1],c=j[0],e=j[1],b=j[2],this.trigger=function(a,b){return f.getUrl()!==f.opts.emptyMP3?i.call(f,a,b):void 0},d=function(a){return a=a||f.getLoadedPercent(),f.trigger(g.PROGRESS,a),1===a?(clearInterval(e),b=!0,f.setState(h.CANPLAYTHROUGH)):void 0},a.on("loadstart",function(){return b=!1,clearInterval(e),e=setInterval(function(){return d()},50),f.setState(h.PREBUFFER)}).on("playing",function(){return clearTimeout(c),f.setState(h.PLAYING)}).on("pause",function(){return f.setState(f.getCurrentPosition()&&h.PAUSE||h.STOP)}).on("ended",function(){return f.setState(h.END)}).on("error",function(a){return clearTimeout(c),c=setTimeout(function(){return f.trigger(g.ERROR,a)},2e3)}).on("waiting",function(){return f.setState(h.PREBUFFER)}).on("loadeddata",function(){return f.setState(h.BUFFERING)}).on("timeupdate",function(){return f.trigger(g.POSITIONCHANGE,f.getCurrentPosition())}).on("progress",function(a){var c,f;return clearInterval(e),b?void 0:(c=a.loaded||0,f=a.total||1,d(c&&1*(c/f).toFixed(2)))})},c.prototype._needCanPlay=function(a){var c,d,e,f,g,h;for(e=this,c=this.audio,h=[],f=0,g=a.length;g>f;f++)d=a[f],h.push(this[d]=b.wrap(this[d],function(){var a,b,d;b=arguments[0],a=2<=arguments.length?__slice.call(arguments,1):[];try{b.apply(e,a)}catch(f){d=function(){return b.apply(e,a),c.off("canplay",d)},c.on("canplay",d)}return e}));return h},c.prototype.play=function(){return this.audio.play(),this},c.prototype.pause=function(){return this.audio.pause(),this},c.prototype.stop=function(){try{this.audio.currentTime=0}catch(a){return}finally{this.pause()}return this},c.prototype.setUrl=function(a){return a&&(this.audio.src=a,this.audio.load()),c.__super__.setUrl.call(this,a)},c.prototype.setVolume=function(a){return this.audio.volume=a/100,c.__super__.setVolume.call(this,a)},c.prototype.setMute=function(a){return this.audio.muted=a,c.__super__.setMute.call(this,a)},c.prototype.setCurrentPosition=function(a){try{this.audio.currentTime=a/1e3}catch(b){return}finally{this.play()}return this},c.prototype.getCurrentPosition=function(){return 1e3*this.audio.currentTime},c.prototype.getLoadedPercent=function(){var a,b,c,d,e,f;if(a=this.audio,b=a.currentTime,d=a.buffered)for(c=d.length;c--;)if(d.start(c)<=(f=a.currentTime)&&f<=d.end(c)){b=d.end(c);break}return e=this.getTotalTime()/1e3,b=b>e?e:b,e&&1*(b/e).toFixed(2)||0},c.prototype.getTotalTime=function(){var a,b,c,d,e;return e=this.audio,d=e.duration,b=e.buffered,c=e.currentTime,d=~~d,0===d&&b&&(a=b.length,d=a>0?b.end(--a):c),d&&1e3*d||0},c}(c)}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/lib/jquery.swfobject",b):b()}(this,function(){!function(a,b,c){function d(a,b){var c=(a[0]||0)-(b[0]||0);return c>0||!c&&a.length>0&&d(a.slice(1),b.slice(1))}function e(a){if(typeof a!=h)return a;var b=[],c="";for(var d in a)c=typeof a[d]==h?e(a[d]):[d,i?encodeURI(a[d]):a[d]].join("="),b.push(c);return b.join("&")}function f(a){var b=[];for(var c in a)a[c]&&b.push([c,'="',a[c],'"'].join(""));return b.join(" ")}function g(a){var b=[];for(var c in a)b.push(['<param name="',c,'" value="',e(a[c]),'" />'].join(""));return b.join("")}var h="object",i=!0;try{var j=c.description||function(){return new c("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}()}catch(k){j="Unavailable"}var l=j.match(/\d+/g)||[0];a[b]={available:l[0]>0,activeX:c&&!c.name,version:{original:j,array:l,string:l.join("."),major:parseInt(l[0],10)||0,minor:parseInt(l[1],10)||0,release:parseInt(l[2],10)||0},hasVersion:function(a){var b=/string|number/.test(typeof a)?a.toString().split("."):/object/.test(typeof a)?[a.major,a.minor]:a||[0,0];return d(l,b)},encodeParams:!0,expressInstall:"expressInstall.swf",expressInstallIsActive:!1,create:function(a){var b=this;if(!a.swf||b.expressInstallIsActive||!b.available&&!a.hasVersionFail)return!1;if(!b.hasVersion(a.hasVersion||1)){if(b.expressInstallIsActive=!0,"function"==typeof a.hasVersionFail&&!a.hasVersionFail.apply(a))return!1;a={swf:a.expressInstall||b.expressInstall,height:137,width:214,flashvars:{MMredirectURL:location.href,MMplayerType:b.activeX?"ActiveX":"PlugIn",MMdoctitle:document.title.slice(0,47)+" - Flash Player Installation"}}}attrs={data:a.swf,type:"application/x-shockwave-flash",id:a.id||"flash_"+Math.floor(999999999*Math.random()),width:a.width||320,height:a.height||180,style:a.style||""},i="undefined"!=typeof a.useEncode?a.useEncode:b.encodeParams,a.movie=a.swf,a.wmode=a.wmode||"opaque",delete a.fallback,delete a.hasVersion,delete a.hasVersionFail,delete a.height,delete a.id,delete a.swf,delete a.useEncode,delete a.width;var c=document.createElement("div");return c.innerHTML=["<object ",f(attrs),">",g(a),"</object>"].join(""),c.firstChild}},a.fn[b]=function(c){var d=this.find(h).andSelf().filter(h);return/string|object/.test(typeof c)&&this.each(function(){var d,e=a(this);c=typeof c==h?c:{swf:c},c.fallback=this,d=a[b].create(c),d&&(e.children().remove(),e.html(d))}),"function"==typeof c&&d.each(function(){var d=this,e="jsInteractionTimeoutMs";d[e]=d[e]||0,d[e]<660&&(d.clientWidth||d.clientHeight?c.call(d):setTimeout(function(){a(d)[b](c)},d[e]+66))}),d}}(jQuery,"flash",navigator.plugins["Shockwave Flash"]||window.ActiveXObject)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},__slice=[].slice;!function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/engines/flashCore",["muplayer/core/cfg","muplayer/core/utils","muplayer/lib/Timer","muplayer/core/engines/engineCore","muplayer/lib/jquery.swfobject"],b):a._mu.FlashCore=b(_mu.cfg,_mu.utils,_mu.Timer,_mu.EngineCore)}(this,function(a,b,c,d){var e,f,g,h,i,j,k;return k=a.engine,f=k.EVENTS,h=k.STATES,e=k.ERRCODE,j=a.timerResolution,i={1:h.CANPLAYTHROUGH,2:h.PREBUFFER,3:h.BUFFERING,4:h.PLAYING,5:h.PAUSE,6:h.STOP,7:h.END},g=function(a){function d(a){var c,e,f,g;this.opts=g=$.extend({},d.defaults,this.defaults,a),this._state=h.STOP,this._loaded=!1,this._queue=[],this._needFlashReady(["play","pause","stop","setCurrentPosition","_setUrl","_setVolume","_setMute"]),this._unexceptionGet(["getCurrentPosition","getLoadedPercent","getTotalTime"]),c=g.baseDir,e="muplayer_"+setTimeout(function(){},0),f=g.instanceName+"_"+e,b.namespace("engines")[f]=this,f="_mu.engines."+f,this.flash=$.flash.create({swf:c+g.swf+"?t="+Math.floor(+new Date/g.swfCacheTime),id:e,height:1,width:1,allowscriptaccess:"always",wmode:"transparent",expressInstaller:c+g.expressInstaller,flashvars:{_instanceName:f,_buffertime:5e3}}),this.flash.tabIndex=-1,g.$el.append(this.flash),this._initEvents()}return __extends(d,a),d.defaults={swfCacheTime:18e5,expressInstaller:"expressInstall.swf"},d.prototype._test=function(){return this.flash&&$.flash.hasVersion(this.opts.flashVer)?!0:!1},d.prototype._initEvents=function(){var a,b,d;return a=this,this.progressTimer=new c(j),this.positionTimer=new c(j),d=function(){var b;return b=a.getLoadedPercent(),a._lastPer!==b&&(a._lastPer=b,a.trigger(f.PROGRESS,b)),1===b?a.progressTimer.stop():void 0},b=function(){var b;return b=a.getCurrentPosition(),a._lastPos!==b?(a._lastPos=b,a.trigger(f.POSITIONCHANGE,b)):void 0},this.progressTimer.every("100 ms",d),this.positionTimer.every("100 ms",b),this.on(f.STATECHANGE,function(c){var d;switch(d=c.newState){case h.PREBUFFER:case h.PLAYING:a.progressTimer.start();break;case h.PAUSE:case h.STOP:a.progressTimer.stop();break;case h.END:a.progressTimer.reset()}switch(d){case h.PLAYING:return a.positionTimer.start();case h.PAUSE:case h.STOP:return a.positionTimer.stop(),b();case h.END:return a.positionTimer.reset()}})},d.prototype._needFlashReady=function(a){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(this[c]=b.wrap(this[c],function(a){return function(){var b,c;return c=arguments[0],b=2<=arguments.length?__slice.call(arguments,1):[],a._loaded?c.apply(a,b):a._pushQueue(c,b),a}}(this)));return f},d.prototype._unexceptionGet=function(a){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(this[c]=b.wrap(this[c],function(a){return function(){var b,c;c=arguments[0],b=2<=arguments.length?__slice.call(arguments,1):[];try{return c.apply(a,b)}catch(d){return 0}}}(this)));return f},d.prototype._pushQueue=function(a,b){return this._queue.push([a,b])},d.prototype._fireQueue=function(){var a,b,c,d;for(d=[];this._queue.length;)c=this._queue.shift(),b=c[0],a=c[1],d.push(b.apply(this,a));return d},d.prototype.play=function(){return this.flash.f_play(),this},d.prototype.pause=function(){return this.flash.f_pause(),this},d.prototype.stop=function(){return this.flash.f_stop(),this},d.prototype._setUrl=function(a){return this.flash.f_load(a)},d.prototype.setUrl=function(a){var b;return b=this,a&&(this._setUrl(a),function(){var a,c;return c=null,a=function(d){return d.newState===h.PLAYING&&d.oldState===h.PREBUFFER?c=setTimeout(function(){return b.off(f.STATECHANGE,a),b.getCurrentPosition()<100?(b.setState(h.END),b.trigger(f.ERROR,e.MEDIA_ERR_SRC_NOT_SUPPORTED)):void 0},2e3):clearTimeout(c)},b.off(f.STATECHANGE,a).on(f.STATECHANGE,a)}()),d.__super__.setUrl.call(this,a)},d.prototype.getState=function(){return this._state},d.prototype._setVolume=function(a){return this.flash.setData("volume",a)},d.prototype.setVolume=function(a){return this._setVolume(a),d.__super__.setVolume.call(this,a)},d.prototype._setMute=function(a){return this.flash.setData("mute",a)},d.prototype.setMute=function(a){return this._setMute(a),d.__super__.setMute.call(this,a)},d.prototype.setCurrentPosition=function(a){return this.flash.f_play(a),this},d.prototype.getCurrentPosition=function(){return this.flash.getData("position")},d.prototype.getLoadedPercent=function(){return this.flash.getData("loadedPct")},d.prototype.getTotalTime=function(){return this.flash.getData("length")},d.prototype._swfOnLoad=function(){return this._loaded=!0,setTimeout(function(a){return function(){return a._fireQueue()}}(this),0)},d.prototype._swfOnStateChange=function(a){var b;return b=i[a],b?this.setState(b):void 0},d.prototype._swfOnErr=function(a){return this.setState(h.END),this.trigger(f.ERROR,a),"undefined"!=typeof console&&null!==console&&"function"==typeof console.error?console.error(a):void 0},d}(d)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};!function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/engines/flashMP3Core",["muplayer/core/cfg","muplayer/core/engines/flashCore"],b):a._mu.FlashMP3Core=b(_mu.cfg,_mu.FlashCore)}(this,function(a,b){var c,d;return d=a.engine.TYPES,c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.defaults={swf:"muplayer_mp3.swf",instanceName:"MP3Core",flashVer:"9.0.0"},b.prototype._supportedTypes=["mp3"],b.prototype.engineType=d.FLASH_MP3,b}(b)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};!function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/engines/flashMP4Core",["muplayer/core/cfg","muplayer/core/engines/flashCore"],b):a._mu.FlashMP4Core=b(_mu.cfg,_mu.FlashCore)}(this,function(a,b){var c,d;return d=a.engine.TYPES,c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.defaults={swf:"muplayer_mp4.swf",instanceName:"MP4Core",flashVer:"9.0.115"},b.prototype._supportedTypes=["m4a"],b.prototype.engineType=d.FLASH_MP4,b}(b)}),function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/core/engines/engine",["muplayer/core/cfg","muplayer/core/utils","muplayer/lib/events","muplayer/core/engines/engineCore","muplayer/core/engines/audioCore","muplayer/core/engines/flashMP3Core","muplayer/core/engines/flashMP4Core"],b):a._mu.Engine=b(_mu.cfg,_mu.utils,_mu.Events,_mu.EngineCore,_mu.AudioCore,_mu.FlashMP3Core,_mu.FlashMP4Core)}(this,function(cfg,utils,Events,EngineCore,AudioCore,FlashMP3Core,FlashMP4Core){var EVENTS,Engine,STATES,timerResolution,_ref;return _ref=cfg.engine,EVENTS=_ref.EVENTS,STATES=_ref.STATES,timerResolution=cfg.timerResolution,Engine=function(){function Engine(a){this.opts=$.extend({},this.defaults,a),this._initEngines()}return Engine.el='<div id="muplayer_container_{{DATETIME}}" style="width: 1px; height: 1px; overflow: hidden"></div>',Engine.prototype.defaults={engines:[{constructor:FlashMP3Core},{constructor:FlashMP4Core},{constructor:AudioCore}]},Engine.prototype._initEngines=function(){var $el,args,constructor,engine,i,opts,_i,_len,_ref1;for(this.engines=[],opts=this.opts,$el=$(Engine.el.replace(/{{DATETIME}}/g,+new Date)).appendTo("body"),_ref1=opts.engines,i=_i=0,_len=_ref1.length;_len>_i;i=++_i){engine=_ref1[i],constructor=engine.constructor,args=engine.args||{},args.baseDir=opts.baseDir,args.$el=$el;try{$.isFunction(constructor)||(constructor=eval(constructor)),engine=new constructor(args)}catch(_error){throw new Error("Missing constructor: "+String(engine.constructor))}engine._test()&&this.engines.push(engine)}return this.setEngine(this.engines.length?this.engines[0]:new EngineCore)},Engine.prototype.setEngine=function(a){var b,c,d,e,f,g,h,i;return g=this,this._lastE={},h=function(a){var b,c;return b=a.newState,c=a.oldState,c!==g._lastE.oldState||b!==g._lastE.newState?(g._lastE={oldState:c,newState:b},g.trigger(EVENTS.STATECHANGE,a),b!==STATES.CANPLAYTHROUGH||c!==STATES.PLAYING&&c!==STATES.PAUSE?void 0:g.setState(c)):void 0},e=function(a){return g.trigger(EVENTS.POSITIONCHANGE,a)},f=function(a){return g.trigger(EVENTS.PROGRESS,a)},c=function(a){return g.trigger(EVENTS.ERROR,a)},b=function(a){return a.on(EVENTS.STATECHANGE,h).on(EVENTS.POSITIONCHANGE,e).on(EVENTS.PROGRESS,f).on(EVENTS.ERROR,c)},i=function(a){return a.off(EVENTS.STATECHANGE,h).off(EVENTS.POSITIONCHANGE,e).off(EVENTS.PROGRESS,f).off(EVENTS.ERROR,c)},this.curEngine?this.curEngine!==a?(d=this.curEngine,i(d).reset(),this.curEngine=b(a),this.curEngine.setVolume(d.getVolume()).setMute(d.getMute())):void 0:this.curEngine=b(a)},Engine.prototype.canPlayType=function(a){return"mp4a"===a&&(a="m4a"),-1!==$.inArray(a,this.getSupportedTypes())},Engine.prototype.getSupportedTypes=function(){var a,b,c,d,e;for(b=[],e=this.engines,c=0,d=e.length;d>c;c++)a=e[c],b=b.concat(a.getSupportedTypes());return b},Engine.prototype.switchEngineByType=function(a){var b,c,d,e,f;for(c=!1,f=this.engines,d=0,e=f.length;e>d;d++)if(b=f[d],b.canPlayType(a)){this.setEngine(b),c=!0;break}return c?void 0:this.setEngine(this.engines[0])},Engine.prototype.reset=function(){return this.curEngine.reset(),this},Engine.prototype.setUrl=function(a){var b;if(b=utils.getExt(a),!this.canPlayType(b))throw new Error("Can not play with: "+b);return this.curEngine.canPlayType(b)||this.switchEngineByType(b),this.curEngine.setUrl(a),this},Engine.prototype.getUrl=function(){return this.curEngine.getUrl()},Engine.prototype.play=function(){return this.curEngine.play(),this},Engine.prototype.pause=function(){return this.curEngine.pause(),this.trigger(EVENTS.POSITIONCHANGE,this.getCurrentPosition()),this.setState(STATES.PAUSE),this},Engine.prototype.stop=function(){return this.curEngine.stop(),this.trigger(EVENTS.POSITIONCHANGE,0),this.setState(STATES.STOP),this},Engine.prototype.setState=function(a){return this.curEngine.setState(a),this},Engine.prototype.getState=function(){return this.curEngine.getState()},Engine.prototype.setMute=function(a){return this.curEngine.setMute(!!a),this},Engine.prototype.getMute=function(){return this.curEngine.getMute()},Engine.prototype.setVolume=function(a){return $.isNumeric(a)&&a>=0&&100>=a&&this.curEngine.setVolume(a),this},Engine.prototype.getVolume=function(){return this.curEngine.getVolume()},Engine.prototype.setCurrentPosition=function(a){return a=~~a,this.curEngine.setCurrentPosition(a),this},Engine.prototype.getCurrentPosition=function(){return this.curEngine.getCurrentPosition()},Engine.prototype.getLoadedPercent=function(){return this.curEngine.getLoadedPercent()},Engine.prototype.getTotalTime=function(){return this.curEngine.getTotalTime()},Engine.prototype.getEngineType=function(){return this.curEngine.engineType},Engine}(),Events.mixTo(Engine),Engine
}),function(a,b){return"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("muplayer/player",["muplayer/core/cfg","muplayer/core/utils","muplayer/lib/Timer","muplayer/lib/events","muplayer/core/playlist","muplayer/core/engines/engine"],b):a._mu.Player=b(_mu.cfg,_mu.utils,_mu.Timer,_mu.Events,_mu.Playlist,_mu.Engine)}(this,function(a,b,c,d,e,f){var g,h,i,j,k,l;return l=a.engine,g=l.EVENTS,i=l.STATES,k=b.time2str,j=function(a,b){var c,d;return"prev"!==a&&"next"!==a?this:(this.stop(),c=this.playlist,d=function(c){return function(){var d;return d={cur:c.getCur()},b&&(d.auto=b),c.trigger("player:"+a,d),c.play()}}(this),this.getSongsNum()&&(c.cur?c[a]()&&d():d()),this)},h=function(){function b(a){var b,g;if(this.opts=g=$.extend({},this.defaults,a),this.waitingTimer=new c(100),b=g.baseDir,b===!1)b="";else if(!b)throw new Error("baseDir must be set! Usually, it should point to the MuPlayer's dist directory.");if(b&&!b.endsWith("/")&&(b+="/"),g.singleton){if(d)return d;d=this}this.playlist=new e({absoluteUrl:g.absoluteUrl}),this.playlist.setMode(g.mode),this._initEngine(new f({baseDir:b,engines:g.engines})),this.setMute(g.mute),this.setVolume(g.volume),this.reset()}var d;return d=null,b.prototype.defaults={baseDir:""+a.cdn+a.version,mode:"loop",mute:!1,volume:80,singleton:!0,absoluteUrl:!0,maxRetryTimes:1,maxWaitingTime:4e3,recoverMethodWhenWaitingTimeout:"retry",fetch:function(){var a,b;return b=$.Deferred(),a=this.getCur(),this.getUrl()===a?b.resolve():setTimeout(function(c){return function(){return c.setUrl(a),b.resolve()}}(this),0),b.promise()}},b.prototype._initEngine=function(a){var b,c,d;return d=this,b=this.opts,c=b.recoverMethodWhenWaitingTimeout,this.engine=a.on(g.STATECHANGE,function(a){var b;return b=a.newState,b!==i.PREBUFFER&&b!==i.BUFFERING&&d.waitingTimer.clear(),d.trigger("player:statechange",a),d.trigger(b),b===i.END?d.next(!0):void 0}).on(g.POSITIONCHANGE,function(c){return c?(d.trigger("timeupdate",c),d.getUrl()?d.waitingTimer.clear().after(b.maxWaitingTime,function(){var b;return(b=d.getState())!==i.PAUSE&&b!==i.STOP&&b!==i.END?a.trigger(g.WAITING_TIMEOUT):void 0}).start():void 0):void 0}).on(g.PROGRESS,function(a){return d.trigger("progress",a)}).on(g.ERROR,function(a){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.error&&console.error("error: ",a),d.trigger("error",a)}).on(g.WAITING_TIMEOUT,function(){return("retry"===c||"next"===c)&&d[c](),d.trigger("player:waiting_timeout")})},b.prototype.retry=function(){var a,b;return this._retryTimes<this.opts.maxRetryTimes?(this._retryTimes++,b=this.getUrl(),a=this.engine.getCurrentPosition(),this.pause().setUrl(b).engine.setCurrentPosition(a),this.trigger("player:retry",this._retryTimes)):this.trigger("player:retry:max"),this},b.prototype.play=function(a){var b,c,d,e,f;return e=this,c=this.engine,b=$.Deferred(),a=~~a,d=function(){return setTimeout(function(){return e.getUrl()&&(a?c.setCurrentPosition(a):c.play()),e.trigger("player:play",a),b.resolve()},0)},"play"!==this._st&&(this._st="play",f=this.getState(),f===i.STOP||f===i.END||f===i.BUFFERING&&0===this.curPos()?(this.trigger("player:fetch:start"),this.opts.fetch.call(this).done(function(){return e.trigger("player:fetch:done"),d()})):d()),b.promise()},b.prototype.pause=function(){return"pause"!==this._st&&(this._st="pause",this.engine.pause(),this.trigger("player:pause")),this},b.prototype.stop=function(){return"stop"!==this._st&&(this._st="stop"),this.engine.stop(),this.trigger("player:stop"),this},b.prototype.replay=function(){return this.stop().play()},b.prototype.prev=function(){return j.apply(this,["prev"])},b.prototype.next=function(a){return j.apply(this,["next",a])},b.prototype.getCur=function(){var a,b;return b=this.playlist,a=b.cur,!a&&this.getSongsNum()&&(a=b.list[0],b.setCur(a)),a+""},b.prototype.setCur=function(a){var b;return b=this.playlist,!a&&this.getSongsNum()&&(a=b.list[0]),a&&this._sid!==a&&(b.setCur(a),this._sid=a,this.stop()),this},b.prototype.curPos=function(a){var b;return b=this.engine.getCurrentPosition()/1e3,a?k(b):b},b.prototype.duration=function(a){var b;return b=this.engine.getTotalTime()/1e3,a?k(b):b},b.prototype.add=function(a,b){return null==b&&(b=!0),a&&this.playlist.add(a,b),this.trigger("player:add",a),this},b.prototype.remove=function(a){return a&&this.playlist.remove(a),this.getSongsNum()||this.reset(),this.trigger("player:remove",a),this},b.prototype.reset=function(){return delete this._sid,this._retryTimes=0,this.playlist.reset(),this.engine.reset(),this.trigger("player:reset"),this},b.prototype.getState=function(){return this.engine.getState()},b.prototype.setUrl=function(a){return a?(this.stop().engine.setUrl(a),this.trigger("player:setUrl",a),this):this},b.prototype.getUrl=function(){return this.engine.getUrl()},b.prototype.setVolume=function(a){return this.engine.setVolume(a),this.trigger("player:setVolume",a),this},b.prototype.getVolume=function(){return this.engine.getVolume()},b.prototype.setMute=function(a){return this.engine.setMute(a),this.trigger("player:setMute",a),this},b.prototype.getMute=function(){return this.engine.getMute()},b.prototype.canPlayType=function(a){return this.engine.canPlayType(a)},b.prototype.getSongsNum=function(){return this.playlist.list.length},b.prototype.setMode=function(a){return this.playlist.setMode(a),this.trigger("player:setMode",a),this},b.prototype.getMode=function(){return this.playlist.mode},b.prototype.getEngineType=function(){return this.engine.curEngine.engineType},b}(),d.mixTo(h),h}),function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var player=new _mu.Player({engines:[{constructor:"AudioCore"}]}),btnSnd="sounds/ui_Buttons.mp3",backSnd="sounds/background.mp3",winSnd="sounds/slots_win_fruit_00.mp3",Slots=function(){this.WINDOW_WIDTH=window.innerWidth,this.WINDOW_HEIGHT=window.innerHeight,this.COLORS=["#FAFA17","#ff1493","#adff2f","#c617e8","#F1753F","#ffffff","#E9282F","#55BEED","#EA2830"],this.bodyImagesSize={width:640,height:377},this.spinImagesSize={width:96,height:96},this.itemSize={width:84,height:84},this.realBodyImageWidth=~~this.WINDOW_WIDTH,this.ratio=this.realBodyImageWidth/this.bodyImagesSize.width,this.canvas=$("#canvas")[0],this.ctx=this.canvas.getContext("2d"),this.realBodyImageHeight=~~(this.ratio*this.bodyImagesSize.height),this.$spinBtn=$("#spinBtn"),this.$mkBetBtn=$("#mkBet"),this.$betLineBtn=$("#betLine"),this.$totalBet=$("#totalBet"),this.GAME_STATUS=0,this.score=0,this.ITEM_CNT=10,this.user={usercode:0,username:"未知",nickname:"未知",playerId:0,userId:0,headimgurl:"images/default_avatar.jpg",wealth:0,today:0,user_info_ready:!1},this.items={icons:[],readyCnt:0},this.game={bet:1,lineCnt:1,betRate:1,firstWin:0},this.wheel=null,this.layout=[],this.linesInfo=[0,0,0,0,0,0,0,0,0],this.defaultPos=[],this.snds=[],this.LINES=9,this.BET_PER_LINE=1,this.MAX_BET=10,this.LOTERY_LINES=[[2,5,8,11,14],[1,4,7,10,13],[3,6,9,12,15],[1,5,9,11,13],[3,5,7,11,15],[1,4,8,12,15],[3,6,8,10,13],[2,6,8,10,14],[2,4,8,12,14]],this.holderImg=new Image,this.holderImg.src="images/holder.jpg"};Slots.prototype={init:function(){var a=this;$(".first-info,.round-result-info").hide(),this.wheel={top:~~(90*a.ratio),left:~~(85*a.ratio),width:~~(90*a.ratio),height:~~(240*a.ratio),gutter:~~(5*a.ratio),canvasWidth:~~(455*a.ratio),canvasHeight:~~(240*a.ratio),itemWidth:~~(a.itemSize.width*a.ratio),itemHeight:~~a.itemSize.height*a.ratio},this.defaultPos=function(){for(var b=0,c=0,d=[],e=0;15>e;e++)0!=e&&e%3==0&&(b+=a.wheel.gutter+a.wheel.width,c=0),d.push({x:b,y:c}),c+=a.wheel.itemHeight;return d}(),this.$spinBtn.find("img").css("width",~~(this.ratio*this.spinImagesSize.width)),this.initCanvas(a),this.loadResource(a),this.layout=this.getRandomLayout(a),this.getUserData(a),this.run(a),this.$spinBtn.on("click",function(){if(0==a.GAME_STATUS||3==a.GAME_STATUS){if(ios&&player.setUrl(btnSnd).play(),a.user.wealth<a.game.bet*a.game.lineCnt)return void alert("金钱不够哦~明天再来吧");a.checkValidation(a)?(console.info("game start!"),ios&&player.setUrl(backSnd).play(),a.spin(a)):console.log("game is running")}}),this.$mkBetBtn.on("click",function(){if(0==a.GAME_STATUS||3==a.GAME_STATUS){var b=$("#betPerLineCnt"),c=+b.text();(c+10)*+$("#linesCnt").text()<a.user.wealth&&b.text()<981&&(c+=10),b.text(c),a.game.bet=c,a.$totalBet.text(c*+$("#linesCnt").text()),ios&&player.setUrl(btnSnd).play()}}),this.$betLineBtn.on("click",function(){if(0==a.GAME_STATUS||3==a.GAME_STATUS){var b=$("#linesCnt"),c=+b.text();9>c&&(c+1)*+$("#betPerLineCnt").text()<a.user.wealth?c++:c=1,a.game.lineCnt=c,b.text(c),a.$totalBet.text(c*+$("#betPerLineCnt").text()),ios&&player.setUrl(btnSnd).play()}}),$("#help").on("tap click",function(){$.pgwModal({title:"倍率表",titleBar:!1,target:"#playtableContent"}),$.pgwModal("reposition")}),$("#rankBoard").on("click",function(){$.ajax({url:"http://54.223.144.172:18090/sgac/forwardList.action",data:{playerId:a.user.playerId,usercode:a.user.userId,mid:1020,gameId:90031,type:1,tType:1,roomId:1,msgid:2203},dataType:"json",success:function(a){var b=a,c=b.rankList.slice(0,10),d='<div class="rank-container"><table class="rank-table">';c.forEach(function(a,e){d+='<tr><td class="rank-cnt-col"> '+(+e+1)+' </td><td class="rank-user-col"> <span class="rank-nickname">'+(c[e].name.length>25?c[e].name.substr(0,22)+"...":c[e].name)+"</span> <br> <span>"+b.rankList[e].content+"</span> </td></tr>"}),d+='</table><div class="mine-rank"><span>我的排名：'+b.selfRank+"</span></div></div>",$.pgwModal({title:"排行榜",content:d})},error:function(){}})})},getRandomLayout:function(a){for(var b=[],c=14;c>=0;c--)b.push(~~(Math.random()*a.ITEM_CNT));return b},initCanvas:function(a){$("#canvas").attr({width:a.wheel.canvasWidth,height:a.wheel.canvasHeight}).css({top:a.wheel.top,left:a.wheel.left})},checkValidation:function(a){return 0!=a.GAME_STATUS&&3!=a.GAME_STATUS||!a.user.user_info_ready||a.items.readyCnt!=a.ITEM_CNT?!1:!0},loadResource:function(a){for(var b=a.ITEM_CNT-1;b>-1;b--)a.items.icons[b]=new Image,a.items.icons[b].onload=function(){a.items.readyCnt++,a.items.readyCnt==a.ITEM_CNT&&$("#loading-wrapper").css({display:"none"})},a.items.icons[b].src="images/items/"+b+".png"},getUserData:function(a){var b=a.getQueryString();a.user.userId=b.usercode||"20141016205157252083",$.ajax({url:"http://54.223.144.172:18090/sgac/transit.action",data:{action:"userinfo",usercode:a.user.userId},dataType:"json",success:function(b){a.user.username=b.username||"ohwWZjn0TEp-6OkN92gCDJYO6dVg",a.user.nickname=b.nikeName||"未知",a.user.headimgurl=b.headimgurl||"images/default_avatar.jpg",$("#nickname").text(a.user.nickname.length>5?a.user.nickname.substr(0,5)+"...":a.user.nickname),$("#avatar").attr("src",a.user.headimgurl),$.ajax({url:"http://54.223.144.172:18090/sgac/thirdPartyLogin.action",data:{userName:a.user.nickname,userId:a.user.userId,usercode:a.user.userId},dataType:"json",success:function(b){a.user.playerId=b.playerId,$.ajax({url:"http://54.223.144.172:18090/sgac/forwardList.action",data:{gameId:90031,usercode:a.user.userId,playerId:a.user.playerId,roomId:1,msgid:20050,mid:1020,type:1,name:a.user.nickname},dataType:"json",success:function(b){a.user.wealth=+b.tableInfo.info[0].chips,a.user.user_info_ready=!0,$("#wealth").text(a.user.wealth)},error:function(){alert("获取用户信息失败，请检查网络")}})},error:function(){alert("登入失败，请重试")}})},error:function(){alert("从中彩汇获取数据失败！")}})},getQueryString:function(){for(var a={},b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if("undefined"==typeof a[e[0]])a[e[0]]=e[1];else if("string"==typeof a[e[0]]){var f=[a[e[0]],e[1]];a[e[0]]=f}else a[e[0]].push(e[1])}return a},spin:function(a){a.GAME_STATUS=1,a.user.winBet=0,a.user.wealth=$("#wealth").text(),$("#winScore").text("$0"),$.ajax({url:"http://54.223.144.172:18090/sgac/forwardList.action",data:{name:a.user.nickname,usercode:a.user.userId,playerId:a.user.playerId,lines:$("#linesCnt").text(),betPerLine:$("#betPerLineCnt").text(),type:1,gameId:90031,roomId:1,msgid:20052,mid:1020},dataType:"json",success:function(b){1==b.firstWin&&(a.game.firstWin=1,$.ajax({url:"http://54.223.144.172:18090/sgac/transit.action",data:{action:"playresult",usercode:a.user.userId,gametime:0,coins:b.win,exp:0,gamename:"slots"},dataType:"json",success:function(a){$("#firstInfo").text("喜中彩金￥"+a.winnings)},error:function(){alert("与中彩汇通信失败，无法获取首次中奖的信息！")}})),setTimeout(function(){a.GAME_STATUS=2,a.user.winBet=b.win,a.user.wealth=b.chips,a.layout=b.wheelTable,a.linesInfo=b.linesInfo,console.log(a.linesInfo,a.layout),player.stop()},7e3)},error:function(){a.GAME_STATUS=2,a.user.winBet=0,alert("获取中奖结果出错，请检查网络")}})},run:function(a){function b(){c.width=c.width,1==a.GAME_STATUS?k>j&&j++:2==a.GAME_STATUS&&(i[0].y<a.defaultPos[0].y+2&&i[0].y>a.defaultPos[0].y-2?(a.user.winBet>0?(a.GAME_STATUS=3,$("#winScore").text("$"+a.user.winBet),1==a.game.firstWin?($(".first-info").show(),a.game.firstWin=0):$("#roundResultInfo1").show(),setTimeout(function(){$("#roundResultInfo1").hide(),$(".first-info").hide()},3e3),ios&&player.setUrl(winSnd).play()):($("#roundResultInfo2").show(),setTimeout(function(){$("#roundResultInfo2").hide()},3e3),a.GAME_STATUS=0),i=JSON.parse(JSON.stringify(a.defaultPos)),j=0,$("#wealth").text(a.user.wealth)):j>2&&j--),a.layout.forEach(function(a,b){i[b].y>e.height&&(i[b].y=-e.itemHeight),i[b].y+=j,d.drawImage(h[a]||new Image,i[b].x,i[b].y,f,g)}),3==a.GAME_STATUS&&a.linesInfo.forEach(function(b,c){b>0&&(d.beginPath(),d.lineWidth=5,d.fillStyle="#000",a.LOTERY_LINES[c].forEach(function(a,b){0==b?d.moveTo(i[a-1].x+f/2,i[a-1].y+g/2):d.lineTo(i[a-1].x+f/2+e.gutter,i[a-1].y+g/2)}),d.strokeStyle=a.COLORS[c],d.stroke())}),requestAnimationFrame(b)}var c=a.canvas,d=this.ctx,e=a.wheel,f=e.itemWidth,g=e.itemHeight,h=(e.width,a.items.icons),i=JSON.parse(JSON.stringify(a.defaultPos)),j=0,k=20;requestAnimationFrame(b)}};var ios=navigator.userAgent.indexOf("iPad")>0||navigator.userAgent.indexOf("iPhone")>0;$(function(){Origami.fastclick(document.body),setTimeout(function(){$(".main-wrapper").height(window.innerHeight);var a=new Slots;a.init()},150)});